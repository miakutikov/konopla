{{ define "main" }}
<div class="container">

  {{ partial "breadcrumbs.html" . }}

  {{ $publishedNews := where (where .Site.RegularPages "Section" "news") ".Params.draft" "ne" true }}
  {{ $publishedPages := where .Pages ".Params.draft" "ne" true }}

  <section class="news-page-layout">
    <!-- Category sidebar -->
    <aside class="categories-sidebar">
      <h3 class="sidebar-heading">–ö–∞—Ç–µ–≥–æ—Ä—ñ—ó</h3>
      <ul class="categories-list">
        <li>
          <a href="{{ "/news/" | relURL }}" class="category-item">
            <span class="category-name">–£—Å—ñ –Ω–æ–≤–∏–Ω–∏</span>
            <span class="category-count">{{ len $publishedNews }}</span>
          </a>
        </li>
        {{ $currentTitle := .Title | lower }}
        {{ $categories := slice
          (dict "name" "—Ç–µ–∫—Å—Ç–∏–ª—å" "emoji" "üßµ")
          (dict "name" "–±—É–¥—ñ–≤–Ω–∏—Ü—Ç–≤–æ" "emoji" "üèóÔ∏è")
          (dict "name" "–∞–≥—Ä–æ" "emoji" "üå±")
          (dict "name" "–±—ñ–æ–ø–ª–∞—Å—Ç–∏–∫" "emoji" "‚ôªÔ∏è")
          (dict "name" "—Ö–∞—Ä—á–æ–≤–∞" "emoji" "ü•ó")
          (dict "name" "–∞–≤—Ç–æ–ø—Ä–æ–º" "emoji" "üöó")
          (dict "name" "–µ–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞" "emoji" "‚ö°")
          (dict "name" "–∫–æ—Å–º–µ—Ç–∏–∫–∞" "emoji" "‚ú®")
          (dict "name" "–Ω–∞—É–∫–∞" "emoji" "üî¨")
          (dict "name" "–µ–∫–æ–ª–æ–≥—ñ—è" "emoji" "üåç")
          (dict "name" "–±—ñ–∑–Ω–µ—Å" "emoji" "üíº")
          (dict "name" "–∑–∞–∫–æ–Ω–æ–¥–∞–≤—Å—Ç–≤–æ" "emoji" "üìã")
        }}
        {{ range $categories }}
        {{ $count := 0 }}
        {{ with index $.Site.Taxonomies.categories (lower .name) }}
          {{ $count = .Count }}
        {{ end }}
        {{ if gt $count 0 }}
        <li>
          <a href="{{ "/categories/" | relURL }}{{ .name | urlize }}/" class="category-item {{ if eq (lower .name) $currentTitle }}active{{ end }}">
            <span class="category-emoji">{{ .emoji }}</span>
            <span class="category-name">{{ .name | title }}</span>
            <span class="category-count">{{ $count }}</span>
          </a>
        </li>
        {{ end }}
        {{ end }}
      </ul>
      {{ if $.Site.Taxonomies.tags }}
      <div class="sidebar-tags">
        <h3 class="sidebar-heading">–¢–µ–≥–∏</h3>
        <div class="tags">
          {{ range $name, $pages := $.Site.Taxonomies.tags }}
          <a href="{{ "/tags/" | relURL }}{{ $name | urlize }}/" class="tag">#{{ $name }}</a>
          {{ end }}
        </div>
      </div>
      {{ end }}
    </aside>

    <!-- News content -->
    <div class="news-content">
      <div class="news-content-header">
        <h1>{{ .Title }}</h1>
        {{ if .Description }}<p>{{ .Description }}</p>{{ end }}
        <p class="list-count">{{ len $publishedPages }} {{ if eq (len $publishedPages) 1 }}–Ω–æ–≤–∏–Ω–∞{{ else }}–Ω–æ–≤–∏–Ω{{ end }}</p>
      </div>

      {{ $paginator := .Paginate $publishedPages }}
      <div class="news-grid">
        {{ range $paginator.Pages }}
          {{ partial "article-card.html" . }}
        {{ end }}
      </div>

      <!-- Pagination -->
      {{ if gt $paginator.TotalPages 1 }}
      <nav class="pagination">
        {{ if $paginator.HasPrev }}
        <a href="{{ $paginator.Prev.URL }}" class="page-btn">&larr; –ù–æ–≤—ñ—à—ñ</a>
        {{ else }}
        <span class="page-btn disabled">&larr; –ù–æ–≤—ñ—à—ñ</span>
        {{ end }}

        <div class="page-numbers">
          {{ range $paginator.Pagers }}
          {{ if eq . $paginator }}
          <span class="page-num current">{{ .PageNumber }}</span>
          {{ else }}
          <a href="{{ .URL }}" class="page-num">{{ .PageNumber }}</a>
          {{ end }}
          {{ end }}
        </div>

        {{ if $paginator.HasNext }}
        <a href="{{ $paginator.Next.URL }}" class="page-btn">–°—Ç–∞—Ä—ñ—à—ñ &rarr;</a>
        {{ else }}
        <span class="page-btn disabled">–°—Ç–∞—Ä—ñ—à—ñ &rarr;</span>
        {{ end }}
      </nav>
      {{ end }}
    </div>
  </section>

</div>
{{ end }}
